Homework 2
================
Annie Yu
10/3/2018

    ## ── Attaching packages ───────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──

    ## ✔ ggplot2 3.0.0     ✔ purrr   0.2.5
    ## ✔ tibble  1.4.2     ✔ dplyr   0.7.6
    ## ✔ tidyr   0.8.1     ✔ stringr 1.3.1
    ## ✔ readr   1.1.1     ✔ forcats 0.3.0

    ## ── Conflicts ──────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

Problem 1:
==========

``` r
NYC_transit = read_csv(file = "/Users/annie/Desktop/data science/Homework/Homework_2/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
janitor::clean_names() %>% 
select(line, station_name, station_latitude, station_longitude, starts_with("route"), entry, vending, entrance_type, ada) %>% 
mutate(entry = recode(entry, 'YES' = T, 'NO' = F)) 
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_character(),
    ##   `Station Latitude` = col_double(),
    ##   `Station Longitude` = col_double(),
    ##   Route8 = col_integer(),
    ##   Route9 = col_integer(),
    ##   Route10 = col_integer(),
    ##   Route11 = col_integer(),
    ##   ADA = col_logical(),
    ##   `Free Crossover` = col_logical(),
    ##   `Entrance Latitude` = col_double(),
    ##   `Entrance Longitude` = col_double()
    ## )

    ## See spec(...) for full column specifications.

``` r
dim(NYC_transit)
```

    ## [1] 1868   19

How many distinct stations are there?
-------------------------------------

``` r
NYC_transit %>%
 distinct(station_name, line) %>% 
 nrow()
```

    ## [1] 465

How many stations are ADA compliant?
------------------------------------

``` r
NYC_transit %>% 
  filter(ada == T) %>% 
  distinct(station_name, line) %>% 
  dim()
```

    ## [1] 84  2

The proportion of station entrances / exits without vending allow entrance
--------------------------------------------------------------------------

``` r
nrow(NYC_transit %>% filter(entry== T&vending == "NO"))/nrow(NYC_transit %>%  filter(vending =="NO"))
```

    ## [1] 0.3770492

Reformat data so that route number and route name are distinct variables. How many distinct stations serve the A train? Of the stations that serve the A train, how many are ADA compliant?
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

``` r
NYC_transit %>% 
  gather(key = route_number, value = route_name, route1:route11) %>% 
  filter(route_name == 'A') %>% 
  distinct(station_name, line) %>% 
  dim()
```

    ## [1] 60  2

``` r
NYC_transit %>% 
  gather(key = route_number, value = route_name, route1:route11) %>%
  filter(route_name == 'A', ada == T) %>% 
  distinct(station_name, line) %>% 
  dim()
```

    ## [1] 17  2

Problem 2:
==========

``` r
Trash_wheel = readxl::read_xlsx("/Users/annie/Desktop/data science/Homework/Homework_2/HealthyHarborWaterWheelTotals2017-9-26.xlsx") %>% 
janitor::clean_names() %>% 
filter(!dumpster == "NA") %>% 
mutate(sports_balls = as.integer(round(sports_balls,0)))
```

Read and clean precipitation data for 2016 and 2017
---------------------------------------------------

``` r
pre_2017 =  readxl::read_xlsx("/Users/annie/Desktop/data science/Homework/Homework_2/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = 3, range = 'A2:B15') %>% 
  mutate(year = 'rep(2017,13)') %>% 
  filter(!Total == 'NA')
```

``` r
pre_2016 =  readxl::read_xlsx("/Users/annie/Desktop/data science/Homework/Homework_2/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = 4, range = 'A2:B15') %>% 
  mutate(year = 'rep(2016,13)') 
```

``` r
prefull = rbind(pre_2017,pre_2016) %>% 
  mutate(month = as.factor(Month)) 
levels(prefull$month) = month.name
prefull
```

    ## # A tibble: 22 x 4
    ##    Month Total year         month   
    ##    <dbl> <dbl> <chr>        <fct>   
    ##  1     1  2.34 rep(2017,13) January 
    ##  2     2  1.46 rep(2017,13) February
    ##  3     3  3.57 rep(2017,13) March   
    ##  4     4  3.99 rep(2017,13) April   
    ##  5     5  5.64 rep(2017,13) May     
    ##  6     6  1.4  rep(2017,13) June    
    ##  7     7  7.09 rep(2017,13) July    
    ##  8     8  4.44 rep(2017,13) August  
    ##  9    NA 29.9  rep(2017,13) <NA>    
    ## 10     1  3.23 rep(2016,13) January 
    ## # ... with 12 more rows

Problem 3
=========

``` r
library(p8105.datasets)
data(brfss_smart2010)
```

Format the data to use appropriate variable names;
--------------------------------------------------

Focus on the “Overall Health” topic
-----------------------------------

Exclude variables for class, topic, question, sample size, and everything from lower confidence limit to GeoLocation
--------------------------------------------------------------------------------------------------------------------

Structure data so that values for Response (“Excellent” to “Poor”) are column names / variables which indicate the proportion of subjects with each response (which are values of Data\_value in the original dataset)
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Create a new variable showing the proportion of responses that were “Excellent” or “Very Good”
----------------------------------------------------------------------------------------------

``` r
brfss =
  brfss_smart2010 %>% 
  janitor::clean_names() %>%
  filter(topic == "Overall Health") %>% 
  select(-class, -topic, -question, -sample_size, -(confidence_limit_low:geo_location)) %>% 
  spread(key = response, value = data_value) %>% 
  janitor::clean_names() %>%
  mutate(proportion = (excellent + very_good)/ (excellent + very_good + good + fair + poor))
```

How many unique locations are included in the dataset?
------------------------------------------------------

``` r
brfss_smart2010 %>% 
distinct(Locationdesc) %>% 
nrow()
```

    ## [1] 404

How many state are included in the dataset and What state is observed the most?
-------------------------------------------------------------------------------

``` r
brfss_smart2010 %>%
distinct(Locationabbr) %>% 
nrow()
```

    ## [1] 51

``` r
tail(names(sort(table(brfss_smart2010$Locationabbr))),1)
```

    ## [1] "NJ"

In 2002, what is the median of the “Excellent” response value?
--------------------------------------------------------------

``` r
median(brfss$excellent, na.rm = TRUE)
```

    ## [1] 22

Make a histogram of “Excellent” response values in the year 2002.
-----------------------------------------------------------------

``` r
ggplot(filter(brfss, year == 2002),
       aes(x = excellent)) +
         geom_histogram()
```

    ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.

    ## Warning: Removed 2 rows containing non-finite values (stat_bin).

![](P8105_hw2_xy2404_files/figure-markdown_github/unnamed-chunk-16-1.png)

Make a scatterplot showing the proportion of “Excellent” response values in New York County and Queens County (both in NY State) in each year from 2002 to 2010.
----------------------------------------------------------------------------------------------------------------------------------------------------------------

``` r
ggplot(filter(brfss, locationdesc == "NY - New York County"| locationdesc == "NY - Queens County"), aes(x = year, y = excellent))+
  geom_point(aes(color= locationdesc, alpha = 0.5))
```

![](P8105_hw2_xy2404_files/figure-markdown_github/unnamed-chunk-17-1.png)
